import{r as e,o as t,c as l,w as n,h as a,t as o,e as s,F as i,f as r,n as u,a as c,b as d,k as p,i as y,C as f,d as m,W as _,l as g,L as v,u as h,y as b,M as C,z as k}from"./index-CSaaSGkr.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{r as I}from"./uni-app.es.Csk3S8NK.js";import{_ as D,a as T}from"./uni-grid.C5hr2X6D.js";import{_ as M}from"./uni-popup-dialog.CJQDgQTf.js";import{a as F}from"./uni-popup.C0-y-zeJ.js";import{_ as w}from"./uni-icons.DZvpz1YP.js";const S=x({__name:"icon",props:["type","color","fontSize","background"],emits:["onClick"],setup(s,{emit:i}){const r={editor:"",delete:"",editor2:"",calendar:""};return(i,u)=>{const c=I(e("uni-icons"),w);return t(),l(c,{fontFamily:"iconfont",size:s.fontSize,color:s.color},{default:n((()=>[a(o(r[s.type]||s.type),1)])),_:1},8,["size","color"])}}},[["__scopeId","data-v-25524432"]]);const O=x({name:"UniSegmentedControl",emits:["clickItem"],props:{current:{type:Number,default:0},values:{type:Array,default:()=>[]},activeColor:{type:String,default:"#2979FF"},styleType:{type:String,default:"button"}},data:()=>({currentIndex:0}),watch:{current(e){e!==this.currentIndex&&(this.currentIndex=e)}},created(){this.currentIndex=this.current},methods:{_onClick(e){this.currentIndex!==e&&(this.currentIndex=e,this.$emit("clickItem",{currentIndex:e}))}}},[["render",function(e,f,m,_,g,v){const h=p,b=y;return t(),l(b,{class:u([["text"===m.styleType?"segmented-control--text":"segmented-control--button"],"segmented-control"]),style:c({borderColor:"text"===m.styleType?"":m.activeColor})},{default:n((()=>[(t(!0),s(i,null,r(m.values,((e,s)=>(t(),l(b,{class:u([["text"===m.styleType?"":"segmented-control__item--button",s===g.currentIndex&&"button"===m.styleType?"segmented-control__item--button--active":"",0===s&&"button"===m.styleType?"segmented-control__item--button--first":"",s===m.values.length-1&&"button"===m.styleType?"segmented-control__item--button--last":""],"segmented-control__item"]),key:s,style:c({backgroundColor:s===g.currentIndex&&"button"===m.styleType?m.activeColor:"",borderColor:s===g.currentIndex&&"text"===m.styleType||"button"===m.styleType?m.activeColor:"transparent"}),onClick:e=>v._onClick(s)},{default:n((()=>[d(b,null,{default:n((()=>[d(h,{style:c({color:s===g.currentIndex?"text"===m.styleType?m.activeColor:"#fff":"text"===m.styleType?"#000":m.activeColor}),class:u(["segmented-control__text","text"===m.styleType&&s===g.currentIndex?"segmented-control__item--text":""])},{default:n((()=>[a(o(e),1)])),_:2},1032,["style","class"])])),_:2},1024)])),_:2},1032,["class","style","onClick"])))),128))])),_:1},8,["class","style"])}],["__scopeId","data-v-bda4a78b"]]),j=x({__name:"index",props:["visible"],emits:["onCancel"],setup(a,{emit:o}){const s=o,i=()=>{s("onCancel")};return(o,s)=>{const r=I(e("uni-icons"),w),u=y;return a.visible?(t(),l(u,{key:0,class:"container"},{default:n((()=>[d(r,{type:"closeempty",class:"deleteIcon",color:"#999",onClick:i}),f(o.$slots,"default",{},void 0,!0)])),_:3})):m("",!0)}}},[["__scopeId","data-v-b7bb9c1b"]]),R=x({__name:"calculator",props:["price"],emits:["onOk","onChange"],setup(e,{emit:u}){const c=u;let p=[0],f=0,m=1;const _=e=>{if("清零"===e)return c("onChange",0),p=[0],void(f=0);if("OK"===e)return c("onOk",f+(p.length?(p.join("")-0)*m:0)),p=[],void(f=0);if(["+","-"].includes(e))return f+=(p.join("")-0)*m,c("onChange",f),p=[],void(m="-"===e?-1:1);if("number"==typeof e){const t=p.findIndex((e=>"."===e));if(-1!==t&&p.length-t==3)return;p.push(e)}"."===e&&"."!==p[p.length-1]&&p.push(e),c("onChange",p.join("")-0)};return(e,u)=>{const c=y;return t(),s(i,null,[d(c,{class:"countRow"},{default:n((()=>[(t(),s(i,null,r([1,2,3,"+"],(e=>d(c,{class:"countItem",key:e,onClick:t=>_(e)},{default:n((()=>[d(c,{class:"count"},{default:n((()=>[a(o(e),1)])),_:2},1024)])),_:2},1032,["onClick"]))),64))])),_:1}),d(c,{class:"countRow"},{default:n((()=>[(t(),s(i,null,r([4,5,6,"-"],(e=>d(c,{class:"countItem",key:e,onClick:t=>_(e)},{default:n((()=>[d(c,{class:"count"},{default:n((()=>[a(o(e),1)])),_:2},1024)])),_:2},1032,["onClick"]))),64))])),_:1}),d(c,{class:"countRow"},{default:n((()=>[(t(!0),s(i,null,r([[7,"清零"],[8,0],[9,"."],"OK"],((e,s)=>(t(),l(c,{class:"countItem",key:e},{default:n((()=>[s<3?(t(),l(c,{key:0},{default:n((()=>[d(c,{class:"count",onClick:t=>_(e[0])},{default:n((()=>[a(o(e[0]),1)])),_:2},1032,["onClick"]),d(c,{class:"count",onClick:t=>_(e[1])},{default:n((()=>[a(o(e[1]),1)])),_:2},1032,["onClick"])])),_:2},1024)):(t(),l(c,{key:1,class:"countOk",onClick:t=>_(e)},{default:n((()=>[a(o(e),1)])),_:2},1032,["onClick"]))])),_:2},1024)))),128))])),_:1})],64)}}},[["__scopeId","data-v-c48ba8d2"]]);Date.prototype.Format=function(e="yyyy-MM-dd hh:mm:ss"){const t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(const l in t)new RegExp("("+l+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?t[l]:("00"+t[l]).substr((""+t[l]).length)));return e},Date.prototype.FormatDateTime=function(){return this.Format("yyyy-MM-dd hh:mm:ss")},Date.prototype.FormatDate=function(){return this.Format("yyyy-MM-dd")},Date.prototype.FormatTime=function(){return this.Format("hh:mm:ss")},Date.prototype.Short=function(){const e=this.getTime(),t=6e4,l=36e5,n=24*l,a=(new Date).getTime()-e;if(a<0)return;const o=parseInt(a/t),s=parseInt(a/l),i=parseInt(a/n),r=parseInt(a/6048e5),u=parseInt(a/2592e6);let c;if(u>=1&&u<=3)c=" "+u+"月前";else if(r>=1&&r<=3)c=" "+r+"周前";else if(i>=1&&i<=6)c=" "+i+"天前";else if(s>=1&&s<=23)c=" "+s+"小时前";else if(o>=1&&o<=59)c=" "+o+"分钟前";else if(a>=0&&a<=t)c="刚刚";else{const t=new Date;t.setTime(e);c=t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate())}return c},Date.prototype.MonthFirstDay=function(e=null,t="yyyy-MM-dd"){let l=new Date;e&&(l=new Date(e));var n=l.getFullYear(),a=l.getMonth()+1;return 0==a&&(a=12,n-=1),a<10&&(a="0"+a),new Date(n+"-"+a+"-01 00:00:00").Format(t)},Date.prototype.MonthLastDay=function(e=null,t="yyyy-MM-dd"){let l=new Date;e&&(l=new Date(e));var n=l.getFullYear(),a=l.getMonth()+1;0==a&&(a=12,n-=1),a<10&&(a="0"+a);let o=n+"-"+a+"-"+new Date(n,a,0).getDate()+" 23:59:59";return new Date(o).Format(t)};const z=x({__name:"Detail",props:["visible","detail","dataSource"],emits:["onOk","onCancel","onGetClassifyList"],setup(u,{emit:f}){const m=f,x=u;_.database();const w=g(null),z=g(null),V=g({classify:x.detail.classify?x.detail.classify:x.dataSource&&x.dataSource.length>0?x.dataSource[0][0]:{},price:0,billType:"expense",create_date:(new Date).getTime(),...x.detail}),$=v((()=>"income"===V.value.billType?0:1)),E=v((()=>new Date(V.value.create_date).FormatDate("yyyy/MM/dd"))),L=e=>{V.value.billType=0===e.currentIndex?"income":"expense",m("onGetClassifyList",{billType:V.value.billType})},Y=e=>{V.value.price=e},G=()=>{w.value.open()},U=e=>{V.value.title=e},H=e=>{const{detail:{value:t}}=e;V.value.create_date=new Date(t).getTime()},K=()=>{z.value.open()},q=e=>{V.value.desc=e},A=e=>{V.value.price=e,V.value.title||(V.value.title=V.classify.name||""),m("onOk",V.value)},N=()=>{m("onCancel")};return(f,m)=>{const _=I(e("uni-segmented-control"),O),g=y,v=p,x=I(e("uni-grid-item"),D),P=I(e("uni-grid"),T),W=k,B=b,J=C,Q=I(e("uni-popup-dialog"),M),X=I(e("uni-popup"),F);return t(),l(h(j),{class:"modal",visible:u.visible,onOnCancel:N},{default:n((()=>[d(g,{class:"popupHeader"},{default:n((()=>[d(_,{class:"popupTabs",styleType:"text",current:$.value,values:["收入","支出"],onClickItem:L},null,8,["current"])])),_:1}),d(B,{class:"popupContent","indicator-dots":"true"},{default:n((()=>[d(g,{class:"content",style:c({background:V.value.classify?V.value.classify.background:""})},{default:n((()=>[d(g,{class:"contentLeft"},{default:n((()=>[d(S,{type:V.value.classify?V.value.classify.ico:"",color:"#fff",fontSize:"30",class:"contentIcon"},null,8,["type"]),d(v,{onClick:G},{default:n((()=>[a(o(V.value.title||(V.value.classify?V.value.classify.name:"")),1)])),_:1})])),_:1}),d(v,{class:"contentRight"},{default:n((()=>[a("￥"+o(V.value.price.toFixed(2)),1)])),_:1})])),_:1},8,["style"]),(t(!0),s(i,null,r(u.dataSource,((e,u)=>(t(),l(W,{index:u,key:u},{default:n((()=>[d(P,{column:6,"show-border":!1},{default:n((()=>[(t(!0),s(i,null,r(e,((e,s)=>(t(),l(x,{index:s,key:s},{default:n((()=>[d(g,{class:"popupGridItem",onClick:t=>(e=>{V.value.classify=e})(e)},{default:n((()=>[d(S,{type:e.ico,color:e.background,fontSize:"26"},null,8,["type","color"]),d(v,{class:"calssifyTitle"},{default:n((()=>[a(o(e.name),1)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1032,["index"])))),128))])),_:2},1024)])),_:2},1032,["index"])))),128))])),_:1}),d(g,{class:"popupFooter"},{default:n((()=>[d(g,{class:"footerTop"},{default:n((()=>[d(J,{mode:"date",value:E.value,onChange:H},{default:n((()=>[d(g,{class:"uni-input"},{default:n((()=>[a(o(E.value),1)])),_:1})])),_:1},8,["value"]),d(S,{type:"editor2",class:"editIcon",fontSize:"26",onClick:K})])),_:1}),d(R,{price:V.value.price,onOnOk:A,onOnChange:Y},null,8,["price"])])),_:1}),d(X,{ref_key:"titleRef",ref:w,type:"dialog"},{default:n((()=>[d(Q,{mode:"input",maxlength:6,title:V.value.classify?V.value.classify.name:"",modelValue:V.value.title,"onUpdate:modelValue":m[0]||(m[0]=e=>V.value.title=e),placeholder:V.value.classify?V.value.classify.name:"",onConfirm:U},null,8,["title","modelValue","placeholder"])])),_:1},512),d(X,{ref_key:"descRef",ref:z,type:"dialog"},{default:n((()=>[d(Q,{mode:"input",maxlength:"255",title:"备注",modelValue:V.value.desc,"onUpdate:modelValue":m[1]||(m[1]=e=>V.value.desc=e),placeholder:"记录美好生活",onConfirm:q},null,8,["modelValue"])])),_:1},512)])),_:1},8,["visible"])}}},[["__scopeId","data-v-b7a2be77"]]),V=Object.freeze(Object.defineProperty({__proto__:null,default:z},Symbol.toStringTag,{value:"Module"}));export{z as D,S as I,V as a};
